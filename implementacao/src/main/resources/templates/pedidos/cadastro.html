<!DOCTYPE html>
<html lang="pt" xmlns="http://www.w3.org/1999/xhtml"
	  layout:decorate="~{componentes/layout}"
	  xmlns:th="http://thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
	<title>Saída de Produtos</title>
</head>
<body>

	<section class="layout-content" layout:fragment="corpo">
		<div class="page-header">
			<nav class="navbar navbar-expand-md navbar-top bg-light">
				<div class="collapse navbar-collapse" id="navbarsExampleDefault">
					<ul class="navbar-nav">
						<li class="nav-item active">
							<i class="oi oi-caret-right"></i>
							<span>Registrar Pedido</span>
						</li>
					</ul>
				</div>
				<a class="btn btn-dark btn-md mr-1" href="/filiais/listar" role="button">
					<span class="oi oi-spreadsheet" title="Filiais" aria-hidden="true"></span>
					<span>Listar Filiais</span>
				</a>
				<a class="btn btn-dark btn-md" th:href="@{/pedidos/{id}/listar (id=${filial.id})}" role="button">
					<span class="oi oi-spreadsheet" title="Cadastro" aria-hidden="true"></span>
					<span>Listar Pedidos</span>
				</a>
			</nav>
		</div>

		<div class="container" id="cadastro">
			<div class="form-group col-md-12">
				<h4>Registrar Pedido na Filial: <span th:text="${filial.razao}"></span></h4>

			</div>
			<div th:each="msg:${messages}" class="alert alert-danger" role="alert" th:text="${msg}"></div>

			<hr>
			<form th:action="@{/pedidos/{id}/salvar (id=${filial.id})}" th:object="${pedido}" method="POST">
				<div class="form-row">
					<div class="form-group col-md-6">
						<label for="tipo">Tipo de Pedido</label>
						<select id="tipo" class="form-control" th:field="*{tipo}" required>
							<option value="S">Saída</option>
							<option value="E">Entrada</option>
						</select>
						<div class="invalid-feedback">

						</div>
					</div>
					<div class="form-group col-md-6">
						<label for="formapgto">Forma de Pagamento</label>
						<select id="formapgto" class="form-control" th:field="*{formaPagamento}" required>
							<option th:each="fp: ${formasPagamentos}" th:value="${fp.id}" th:text="${fp.descricao}"></option>
						</select>
						<div class="invalid-feedback">

						</div>
					</div>
				</div>
				<div class="form-row">
					<div class="form-group col-md-6">
						<label for="usuario">Usuário</label>
						<select id="usuario" class="form-control" th:field="*{usuario}" required>
							<option th:each="usuario: ${usuarios}" th:value="${usuario.id}" th:text="${usuario.username}"></option>
						</select>
						<div class="invalid-feedback">

						</div>
					</div>
					<div class="form-group col-md-6">
						<label for="cliente">Cliente</label>
						<select id="cliente" class="form-control" th:field="*{cliente}" required>
							<option th:each="cliente: ${clientes}" th:value="${cliente.id}" th:text="${cliente.nome}"></option>
						</select>
						<div class="invalid-feedback">

						</div>
					</div>

				</div>
				<hr>
				<div class="form-row" th:object="${pedidoItem}">
					<div class="form-group col-md-4">
						<label for="produtos">Produtos</label>
						<select id="produtos" class="form-control" th:field="*{produto}" required>
							<option th:each="estoque: ${produtos}"
									th:value="${estoque.produto.id}"
									th:text="${estoque.produto.descricao}"></option>
							<span th:text="${produtos}"></span>
						</select>
						<div class="invalid-feedback"></div>
					</div>
					<div class="form-group col-md-2">
						<label for="quantidade">Quantidade</label>
						<input type="text" class="form-control" id="quantidade" placeholder="qtde"
							   th:field="*{quantidade}" value="" data-mask="#######0.99" data-mask-reverse="false" />
						<div class="invalid-feedback"></div>
					</div>
					<div class="form-group col-md-2">
						<label for="valor">Valor Unitário</label>
						<input type="text" class="form-control" id="valor" placeholder="Valor"
							   th:field="*{valor}" value="" data-mask="#######0.99" data-mask-reverse="false" />
						<div class="invalid-feedback"></div>
					</div>

					<div class="form-group col-md-2">
						<label for="add"> &nbsp; </label><br>
						<button id="add" name="acao" th:value="itens" type="submit" class="btn btn-info ">
							<i class="oi oi-plus"></i>
						</button>
					</div>
				</div>
				<div class="form-row">
					<div class="form-group col-md-12">
						<table class="table table-striped table-hover table-sm">
							<thead>
								<tr>
									<th>Descrição</th>
									<th>Qtde</th>
									<th>Vlr</th>
									<th>Total</th>
									<th>Status</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="item: ${listaPedidoItens}">
									<td th:text="${item.produto.descricao}"></td>
									<td th:text="${item.quantidade}"></td>
									<td th:text="${item.valor}"></td>
									<td th:text="${item.total}"></td>
									<td th:text="${item.status}">
										<!--
										<a class="btn btn-danger btn-sm" th:href="@{/filiais/remover/{id}(id=${filial.id})}" role="button">
											<span class="oi oi-circle-x" title="Excluir" aria-hidden="true"></span>
										</a>
										-->
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="form-row">
					<div class="form-group col-md-6">
						<label for="obs">Observação</label>
						<input type="text" class="form-control" id="obs" placeholder="Observação"
							   autofocus="autofocus" th:field="*{observacao}" value=""/>
						<div class="invalid-feedback">

						</div>
					</div>
				</div>


				<input type="hidden" id="id" th:field="*{id}" value=""/>
				<button type="submit" th:value="salvar" name="acao" class="btn btn-dark btn-sm">Finalizar Pedido</button>
			</form>
		</div>
	</section>

</body>
</html>
